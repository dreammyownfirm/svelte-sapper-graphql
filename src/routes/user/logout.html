<script>
  import * as sapper from '../../../__sapper__/client'

  import { logout } from './_auth'

  export default {
    preload(params) {
      if (this.store.get().isAuth === false) {
        return this.redirect(301, '/')
      }
    },

    async oncreate() {
			let res = await logout(this.store)

			if ( res.status ) {
				let { user } = this.store.get()
				// console.log('login/handleSubmit auth', this.get(), this.store.get())
				this.store.toast({ html: 'You are now signed off', level: 'w' })
			} else {
				this.store.banner({ html: res.msg, level : 'd', duration : 0 })
			}
			return sapper.goto('/')
    }
  }
</script>
