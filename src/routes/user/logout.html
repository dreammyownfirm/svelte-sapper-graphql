<script>
	import * as sapper from '../../../__sapper__/client'

	import {logout} from './_auth'
	
	export default {
		preload(params) {
      if ( this.store.get().isAuth === false) {
        return this.redirect(301, '/')
      }
		},

    oncreate() {
			logout(this.store)
				.then(res => {
					if (res.error) {
						throw res.error
					} else {
						this.store.banner({
							html: "Signed off",
							level: 'warning',
							duration: 3
						})
					}
				})
				.catch(err => {
					console.error('logout/oncreate catch', err)
				})
			return sapper.goto('/')	
		}

	}
</script>